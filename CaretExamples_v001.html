<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Overall Objective</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Overall Objective</h2>

<p>This R Markdown is to document some key ideas I have seen about the &ldquo;caret&rdquo; library in a JHU Coursera module on Practical Machine Learning.  The basic syntax of caret ports across many different analysis techniques, and it seems extremely handy for many phases of analysis.  </p>

<p>The broad themes of care include:  </p>

<ul>
<li>Pre-processing data - preProcess()<br/></li>
<li>Partitioning raw data in to test/train - createDataPartition(), createResample(), createTimeSlices()<br/></li>
<li>Training models on the training data - train()<br/></li>
<li>Applying a training model to an analogous dataset - predict()<br/></li>
<li>Comparing predictions (often to reality) - confusionMatrix()<br/></li>
</ul>

<h2>Caret Usage</h2>

<p>####<em>Basic Example</em><br/>
Below is a basic example for using caret to make and test a simple prediction.  The &ldquo;spam&rdquo; dataset from library &ldquo;kernlab&rdquo; is assessed through this simple example.  </p>

<p>First, the relevant libraries are loaded, with a data partition index creates and then applied to create testing and training data.  Note that -inTrain means exclude the indices contained by inTrain, so testing and training will be mutually exclusive in this case.  </p>

<pre><code class="r">library(caret); 
library(kernlab); 
data(spam, package=&quot;kernlab&quot;) ## make sure to get the kernlab version rather than ElemStatLearn

## Use createDataPartition() to create an index with 75% of the row numbers
inTrain &lt;- createDataPartition(y=spam$type, p=0.75, list=FALSE)
training &lt;- spam[inTrain, ]
testing &lt;- spam[-inTrain, ]
dim(training)
</code></pre>

<pre><code>## [1] 3451   58
</code></pre>

<p>Next, we use caret to run GLM on the training data.  The training syntax almost always looks just like this, although with changes to the ~ formula and/or method statement.  Depending on the method (e.g., bootstrap or resample), there is sometimes an RNG component and thus merit to setting the seed.  Note that caret and all of its sub-components are frequently being updated (sometimes with impact on RNG), so there is no real guarantee of reproducibility once any component(s) of the version originally used has been sunsetted.  </p>

<pre><code class="r">set.seed(32343)

## Runs the GLM and stores the outputs as modelFit
modelFit &lt;- train(type ~ ., data=training, method=&quot;glm&quot;)
</code></pre>

<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
</code></pre>

<pre><code>## Warning: glm.fit: algorithm did not converge
</code></pre>

<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
</code></pre>

<pre><code>## Warning: glm.fit: algorithm did not converge
</code></pre>

<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
</code></pre>

<pre><code class="r">## Prints descriptors of modelFit
modelFit
</code></pre>

<pre><code>## Generalized Linear Model 
## 
## 3451 samples
##   57 predictor
##    2 classes: &#39;nonspam&#39;, &#39;spam&#39; 
## 
## No pre-processing
## Resampling: Bootstrapped (25 reps) 
## Summary of sample sizes: 3451, 3451, 3451, 3451, 3451, 3451, ... 
## Resampling results
## 
##   Accuracy  Kappa      Accuracy SD  Kappa SD  
##   0.917132  0.8263397  0.01646928   0.03148507
## 
## 
</code></pre>

<pre><code class="r">## Prints coefficients that come back from the final GLM selected
modelFit$finalModel
</code></pre>

<pre><code>## 
## Call:  NULL
## 
## Coefficients:
##       (Intercept)               make            address  
##        -1.521e+00         -4.595e-01         -1.462e-01  
##               all              num3d                our  
##         2.402e-01          2.683e+00          5.731e-01  
##              over             remove           internet  
##         1.075e+00          2.166e+00          1.014e+00  
##             order               mail            receive  
##         6.769e-01          1.433e-01         -3.651e-02  
##              will             people             report  
##        -2.165e-01         -1.718e-01          1.545e-01  
##         addresses               free           business  
##         6.325e-01          1.070e+00          1.179e+00  
##             email                you             credit  
##         1.997e-01          1.128e-01          1.539e+00  
##              your               font             num000  
##         2.199e-01          1.811e-01          1.982e+00  
##             money                 hp                hpl  
##         3.484e-01         -2.662e+00         -6.094e-01  
##            george             num650                lab  
##        -9.597e+00          3.763e-01         -2.291e+00  
##              labs             telnet             num857  
##        -5.698e-01          1.112e+00          2.479e+00  
##              data             num415              num85  
##        -6.901e-01         -1.231e+01         -1.621e+00  
##        technology            num1999              parts  
##         1.070e+00          1.651e-01          1.234e+00  
##                pm             direct                 cs  
##        -8.523e-01         -4.626e-01         -5.432e+02  
##           meeting           original            project  
##        -3.560e+00         -1.434e+00         -2.076e+00  
##                re                edu              table  
##        -9.890e-01         -1.644e+00         -2.836e+00  
##        conference      charSemicolon   charRoundbracket  
##        -3.298e+00         -1.069e+00         -2.429e-01  
## charSquarebracket    charExclamation         charDollar  
##        -5.441e-01          2.625e-01          5.190e+00  
##          charHash         capitalAve        capitalLong  
##         2.238e+00          4.304e-03          8.004e-03  
##      capitalTotal  
##         6.973e-04  
## 
## Degrees of Freedom: 3450 Total (i.e. Null);  3393 Residual
## Null Deviance:       4628 
## Residual Deviance: 1333  AIC: 1449
</code></pre>

<pre><code class="r">## Applies modelFit (which was built from training) to make predictions on the testing data
predictions &lt;- predict(modelFit, newdata=testing)

## Runs the confusion matrix and outputs some interesting statistics
confusionMatrix(predictions, testing$type)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction nonspam spam
##    nonspam     661   48
##    spam         36  405
##                                           
##                Accuracy : 0.927           
##                  95% CI : (0.9104, 0.9413)
##     No Information Rate : 0.6061          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.8463          
##  Mcnemar&#39;s Test P-Value : 0.2301          
##                                           
##             Sensitivity : 0.9484          
##             Specificity : 0.8940          
##          Pos Pred Value : 0.9323          
##          Neg Pred Value : 0.9184          
##              Prevalence : 0.6061          
##          Detection Rate : 0.5748          
##    Detection Prevalence : 0.6165          
##       Balanced Accuracy : 0.9212          
##                                           
##        &#39;Positive&#39; Class : nonspam         
## 
</code></pre>

<p>There are frequently warnings thrown back by the caret library, though they often do not seem to impact the predictive ability.  The library is sometimes a bit of a black-box, and prediction is an area that often contains extreme trade-offs between parsimony, intepretability, scalability, predictive power, and the like.  It is wise to be sure the approach and final model align reasonably with how the specific end-user for the algorithm might prioritize these aims.  </p>

<p>####<em>Data Slicing</em><br/>
Continuing with the spam dataset, we may want to slice it.  There are three common methods described below:  </p>

<ul>
<li>k-fold<br/></li>
<li>resample<br/></li>
<li>time slices<br/></li>
</ul>

<pre><code class="r">## ?createFolds will bring up the help menu for all types of data splitting

## Document the length of the spam dataset
length(spam$type)
</code></pre>

<pre><code>## [1] 4601
</code></pre>

<pre><code class="r">## Create 10 folds (all independent)
set.seed(32323)
folds &lt;- createFolds(y=spam$type, k=10, list=TRUE, returnTrain=FALSE)
sapply(folds, FUN=length)
</code></pre>

<pre><code>## Fold01 Fold02 Fold03 Fold04 Fold05 Fold06 Fold07 Fold08 Fold09 Fold10 
##    460    461    460    459    461    459    460    460    461    460
</code></pre>

<pre><code class="r">sum(sapply(folds, FUN=length)) ## same length as original
</code></pre>

<pre><code>## [1] 4601
</code></pre>

<pre><code class="r">myCheck &lt;- NULL
for (intCtr in 1:10) { myCheck &lt;- c(myCheck, folds[[intCtr]]) }
identical(1:length(spam$type), myCheck[order(myCheck)]) ## all elements used exactly once
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<pre><code class="r">folds[[1]][1:10]
</code></pre>

<pre><code>##  [1] 24 27 32 40 41 43 55 58 63 68
</code></pre>

<pre><code class="r">## Create 10 resamples (data can be used multiple times)
set.seed(32323)
folds &lt;- createResample(y=spam$type, times=10, list=TRUE)
sapply(folds, length) ## Each fold same length as original
</code></pre>

<pre><code>## Resample01 Resample02 Resample03 Resample04 Resample05 Resample06 
##       4601       4601       4601       4601       4601       4601 
## Resample07 Resample08 Resample09 Resample10 
##       4601       4601       4601       4601
</code></pre>

<pre><code class="r">myCheck &lt;- NULL
for (intCtr in 1:10) { myCheck &lt;- c(myCheck, folds[[intCtr]]) }
myCount &lt;- NULL
for (intCtr in 1:length(spam$type)) { myCount &lt;- c(myCount, sum(myCheck==intCtr)) }
plot(x=1:length(spam$type), y=myCount, col=&quot;red&quot;, pch=19) ## Indices used different # times
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/></p>

<pre><code class="r">## Create test/train data for a time series (needs to be reasonably contiguous)
set.seed(32323)
tme &lt;- 1:1000 ## For my series, I am interested in times 1-1000
folds &lt;- createTimeSlices(y=tme, initialWindow=20, horizon=10) ## train on 20, test on 10
names(folds)
</code></pre>

<pre><code>## [1] &quot;train&quot; &quot;test&quot;
</code></pre>

<pre><code class="r">folds$train[[1]] ## First fold trains on 1-20
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
</code></pre>

<pre><code class="r">folds$test[[1]] ## First fold tests on 21-30
</code></pre>

<pre><code>##  [1] 21 22 23 24 25 26 27 28 29 30
</code></pre>

<pre><code class="r">folds$train[[length(folds$train)]] ## Last fold trains on 971-990 (max is 1000 per tme)
</code></pre>

<pre><code>##  [1] 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987
## [18] 988 989 990
</code></pre>

<pre><code class="r">folds$test[[length(folds$train)]] ## Last fold tests on 991-1000 (max is 1000 per tme)
</code></pre>

<pre><code>##  [1]  991  992  993  994  995  996  997  998  999 1000
</code></pre>

<p>Some of the algorithms in the caret library take care of these automatically.  However, it is nice to have the flexibility to create partitions in whatever manner is best suited for the task at hand.  </p>

<p>####<em>Training options</em>  </p>

</body>

</html>
